model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
omit = c("source.title","publication.year"),
covariate.labels = c("Economic History", "Econometric", "Econometric $\\times$ EH", paste0("Econometric $\\times$ ", (1999:2018))),
dep.var.labels = "Citations",
type = "text")
# save# modelsave
ggsave("output/plot_changes.pdf", plot_changes, width = 10, height = 6)
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
omit = c("source.title",":as.factor(publication.year"),
covariate.labels = c("Economic History", "Econometric", "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
omit = c("source.title","factor(publication.year"),
covariate.labels = c("Economic History", "Econometric", "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
omit = c("source.title","factor(publication.year)"),
covariate.labels = c("Economic History", "Econometric", "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
#covariate.labels = c("Economic History", "Econometric", "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
data <- data %>%
mutate(econometric_margo2008 = (as.numeric(data$econometric_margo)))
# Define models
model_eh <- lm(times.cited..all.databases ~ eh +
as.factor(publication.year) +
as.factor(source.title), data)
model_eh_econometric <- lm(times.cited..all.databases ~ eh +
econometric_margo2008 +
as.factor(publication.year) +
as.factor(source.title), data)
model_econometric <- lm(times.cited..all.databases ~
econometric_margo2008 +
as.factor(publication.year) +
as.factor(source.title), data)
model_eh_econometric_interaction <- lm(times.cited..all.databases ~
eh +
econometric_margo2008 +
econometric_margo2008:eh +
as.factor(publication.year) +
as.factor(source.title), data)
model_eh_econometric_interaction_years <- lm(times.cited..all.databases ~
eh +
(econometric_margo2008) +
(econometric_margo2008):eh +
publication.year +
as.factor(source.title) +
publication.year:(econometric_margo2008), data)
# Calculate clustered standard errors
cluster_se <- function(model, cluster_var) {
vcovCL <- vcovHC(model, type = "HC1", cluster = cluster_var)
coeftest(model, vcovCL)
}
se_eh <- cluster_se(model_eh, data$source.title)
se_eh <- cluster_se(model_eh, data$source.title)
se_econometric <- cluster_se(model_econometric, data$source.title)
se_econometric <- cluster_se(model_econometric, data$source.title)
se_eh_econometric <- cluster_se(model_eh_econometric, data$source.title)
se_eh_econometric_interaction <- cluster_se(model_eh_econometric_interaction, data$source.title)
se_eh_econometric_interaction <- cluster_se(model_eh_econometric_interaction, data$source.title)
se_model_eh_econometric_interaction_years <- cluster_se(model_eh_econometric_interaction_years, data$source.title)
# Check lengths of standard errors
sapply(se_list, length)
model_eh$coefficients %>% length()
model_eh_econometric_interaction_years$coefficients %>% length()
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric", (2000:2018), "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
#covariate.labels = c("Economic History", "Econometric", (2000:2018), "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
model_eh_econometric_interaction_years <- lm(times.cited..all.databases ~
eh +
(econometric_margo2008) +
(econometric_margo2008):eh +
as.factor(publication.year) +
as.factor(source.title) +
as.factor(publication.year) :(econometric_margo2008), data)
model_eh_econometric_interaction_years <- lm(times.cited..all.databases ~
eh +
(econometric_margo2008) +
(econometric_margo2008):eh +
as.factor(publication.year) +
as.factor(source.title) +
as.factor(publication.year):(econometric_margo2008), data)
# Calculate clustered standard errors
cluster_se <- function(model, cluster_var) {
vcovCL <- vcovHC(model, type = "HC1", cluster = cluster_var)
coeftest(model, vcovCL)
}
se_eh <- cluster_se(model_eh, data$source.title)
se_eh <- cluster_se(model_eh, data$source.title)
se_econometric <- cluster_se(model_econometric, data$source.title)
se_eh_econometric <- cluster_se(model_eh_econometric, data$source.title)
se_eh_econometric_interaction <- cluster_se(model_eh_econometric_interaction, data$source.title)
se_eh_econometric_interaction <- cluster_se(model_eh_econometric_interaction, data$source.title)
se_model_eh_econometric_interaction_years <- cluster_se(model_eh_econometric_interaction_years, data$source.title)
# Extract standard errors
se_list <- list(
se_eh[, "Std. Error"],
se_econometric[, "Std. Error"],
se_eh_econometric[, "Std. Error"],
se_eh_econometric_interaction[, "Std. Error"],
se_model_eh_econometric_interaction_years[, "Std. Error"]
)
se_eh_econometric <- cluster_se(model_eh_econometric, data$source.title)
se_eh_econometric_interaction <- cluster_se(model_eh_econometric_interaction, data$source.title)
se_model_eh_econometric_interaction_years <- cluster_se(model_eh_econometric_interaction_years, data$source.title)
# Extract standard errors
se_list <- list(
se_eh[, "Std. Error"],
se_econometric[, "Std. Error"],
se_eh_econometric[, "Std. Error"],
se_eh_econometric_interaction[, "Std. Error"],
se_model_eh_econometric_interaction_years[, "Std. Error"]
)
# Check lengths of standard errors
sapply(se_list, length)
# Check lengths of standard errors
sapply(se_list, length)
model_eh$coefficients %>% length()
model_eh_econometric_interaction_years$coefficients %>% length()
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric", paste0("Year:", (2000:2018)), "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
# Stargazer with clustered standard errors
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
#covariate.labels = c("Economic History", "Econometric", paste0("Year:", (2000:2018)), "Econometric $\\times$ EH"),
dep.var.labels = "Citations",
type = "text")
gsub(model_eh_econometric_interaction_years$source.title, "as.factor(source.title)","")
gsub(string=model_eh_econometric_interaction_years$source.title, pattern="as.factor(source.title)",""))
gsub(string=model_eh_econometric_interaction_years$source.title, pattern="as.factor(source.title)","")
gsub(x=model_eh_econometric_interaction_years$source.title, pattern="as.factor(source.title)","")
model_eh_econometric_interaction_years$source.title
model_eh_econometric_interaction_years
model_eh_econometric_interaction_years$coefficients
names(model_eh_econometric_interaction_years$coefficients)
data$source.title
unique(data$source.title)
unique(data$source.title)
# Stargazer with clustered standard errors
<- model_eh_econometric_interaction_years$coefficients %>% contains(unique(data$source.title))
model_eh_econometric_interaction_years$coefficients %>% contains(unique(data$source.title))
model_eh_econometric_interaction_years$coefficients
# Stargazer with clustered standard errors
model_eh_econometric_interaction_years$coefficients %>% any(str_detect(unique(data$source.title)))
# Stargazer with clustered standard errors
model_eh_econometric_interaction_years$coefficients %>% any((unique(data$source.title)))
unique(data$source.title)
# Stargazer with clustered standard errors
model_eh_econometric_interaction_years$coefficients %>% str_detect(pattern=unique(data$source.title))
# Stargazer with clustered standard errors
apply(unique(data$source.title), 1, str_detect(model_eh_econometric_interaction_years$coefficients))
# Stargazer with clustered standard errors
apply(unique(data$source.title), 1, str_detect(model_eh_econometric_interaction_years$coefficients))
# Stargazer with clustered standard errors
apply(unique(data$source.title),
1,
str_detect(model_eh_econometric_interaction_years$coefficients))
unique(data$source.title)
# Stargazer with clustered standard errors
coefficients <- model_eh_econometric_interaction_years$coefficients
coefficients
source_titles <- coefficients
source_titles
source_titles <- apply(data$source.title, 1, contains(coefficients ))
data$source.title
apply(data$source.title %>% unique, 1, str_detect(string=coefficients))
coefficients
data$source.title %>% unique()
apply(data$source.title %>% unique(), 1, str_detect(string=coefficients))
source_titles <- apply(data$source.title %>% unique(), 1, function(x) str_detect(string=coefficients, pattern=x))
coefficients
names(coefficients)
apply(data$source.title %>% unique(), 1, function(x) str_detect(string=names(coefficients), pattern=x))
data$source.title %>% unique()
apply(data$source.title %>% unique(), 1, function(x) str_detect(string=names(coefficients), pattern=x))
apply(data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x))
coefficients_index_source.titles <- apply(data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles]
source_title_coefs
names(coefficients)
source_title_coefs <- names(coefficients)[which(coefficients_index_source.titles)]
source_title_coefs
data$source.title %>% unique() %>% as.data.frame()
data$source.title %>% unique() %>% as.data.frame()
data$source.title %>% unique() %>% as.data.frame()
data$source.title %>% unique() %>% as.data.frame()
apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x))
data$source.title %>% unique() %>% as.data.frame()
data$source.title %>% unique() %>% as.data.frame()
coefficients_index_source.titles <- apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x)) %>%
rowSums()
coefficients_index_source.titles
coefficients_index_source.titles <- apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x)) %>%
rowSums()
source_title_coefs <- names(coefficients)[which(coefficients_index_source.titles)]
which(coefficients_index_source.titles)
source_title_coefs <- names(coefficients)[coefficients_index_source.titles]
source_title_coefs <- names(coefficients)[coefficients_index_source.titles]
source_title_coefs
coefficients_index_source.titles <- apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x)) %>%
which()
coefficients_index_source.titles
coefficients_index_source.titles <- apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x)) %>% # get row positions of all true cases
rowSums()
coefficients_index_source.titles
coefficients_index_source.titles <- apply(
data$source.title %>% unique() %>% as.data.frame(), 1, function(x) str_detect(string=names(coefficients), pattern=x)) %>% # get row positions of all true cases
rowSums()
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1]
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% gsub(pattern="as.factor(source.title)",replacement = "")
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% gsub(pattern="as.factor(source.title)", replacement = "")
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
gsub(pattern="as.factor(source.title)", replacement = "")
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
apply(1, gsub(pattern="as.factor(source.title)", replacement = ""))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% as.array() %>%
apply(1, gsub(pattern="as.factor(source.title)", replacement = ""))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% as.array() %>% apply(1, gsub(pattern="as.factor(source.title)", replacement = ""))
names(coefficients)[coefficients_index_source.titles==1] %>% as.array()
names(coefficients)[coefficients_index_source.titles==1] %>% as.data.frame() %>% apply(1, gsub(pattern="as.factor(source.title)", replacement = ""))
names(coefficients)[coefficients_index_source.titles==1] %>% as.data.frame() %>% apply(1, gsub(pattern="as.factor(source.title)", replacement = ""))
names(coefficients)[coefficients_index_source.titles==1] %>% as.data.frame()
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% as.array() %>% apply(1, function (y) gsub(x=y, pattern="as.factor(source.title)", replacement = ""))
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>% as.array() %>% apply(1, function(X) gsub(x=X, pattern="as.factor(source.title)", replacement = ""))
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.array() %>%
apply(1, function(X) gsub(x=X,
pattern="as.factor(source.title)",
replacement = ""))
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
%>%
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
apply(1, function(X) gsub(x=X,
pattern="as.factor(source.title)",
replacement = ""))
names(coefficients)[coefficients_index_source.titles==1]
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.vector()
source_title_coefs
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.vector() %>%
apply(1, function(X) gsub(x=X,
pattern="as.factor(source.title)",
replacement = ""))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = ""))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(x=source_title_coefs,pattern="as.factor(source.title)",replacement = "")
gsub(pattern="as.factor(source.title)",
replacement = "",
x=source_title_coefs)
source_title_coefs
source_title_coefs
gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO",
x=source_title_coefs)
source_title_coefs %>% apply(1, function x gsub(pattern="as.factor(source.title)",
source_title_coefs %>% apply(1, function(x) gsub(pattern="as.factor(source.title)",
source_title_coefs
source_title_coefs %>% apply(1, function(x) gsub(pattern="as.factor(source.title)",
source_title_coefs %>% apply(1, function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
source_title_coefs %>% as.data.frame() %>%  apply(1, function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
source_title_coefs %>% as.data.frame() %>%  lapply(1, function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
source_title_coefs %>% as.data.frame() %>%  lapply(1, function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
source_title_coefs %>% as.data.frame() %>%  lapply( function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
source_title_coefs
source_title_coefs %>% as.data.frame() %>%  lapply( function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
lapply(source_title_coefs, function(x) gsub(pattern="as.factor(source.title)",
replacement = "HELLOOOO", x))
lapply(source_title_coefs, function(x) gsub(pattern="as.factor(source.title)",
replacement = "",
x))
lapply(source_title_coefs %>% unlist(), function(x) gsub(pattern="as.factor(source.title)",
replacement = "",
x))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.data.frame(stringsAsFactors = FALSE)
lapply(source_title_coefs, function(x) gsub(pattern="as.factor(source.title)",
replacement = "",
x))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.data.frame(stringsAsFactors = FALSE)
lapply(source_title_coefs, function(x) gsub(pattern="as.factor(source.title)",
replacement = "",
x))
lapply(source_title_coefs, function(x) gsub(pattern="as.factor\\(source.title\\)",
replacement = "",
x))
source_title_coefs <- names(coefficients)[coefficients_index_source.titles==1] %>%
as.data.frame(stringsAsFactors = FALSE)
source_title_coefs <-lapply(source_title_coefs, function(x) gsub(pattern="as.factor\\(source.title\\)",
replacement = "",
x))
source_title_coefs
paste0("Journal: ",source_title_coefs),
# stargaze
stargazer(model_eh,
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ",source_title_coefs)),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ",source_title_coefs)),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", pull(source_title_coefs))),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs))),
dep.var.labels = "Citations",
type = "text")
source_title_coefs
source_title_coefs %>% unlist()
source_title_coefs <- source_title_coefs %>% unlist()
source_title_coefs
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs))),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs)),
"Economic History $\\times$ Econometric",
paste0("Economic History $\\times$ ", (2000:2018))),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs)),
"Economic History $\\times$ Econometric",
paste0("Economic History $\\times$ ", (2000:2018))),
dep.var.labels = "Citations",
type = "latex")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs)),
"Economic History $\\times$ Econometric",
paste0("Economic History $\\times$ ", (2000:2018))),
dep.var.labels = "Citations",
type = "text")
# stargaze
stargazer(model_eh,
model_eh_econometric,
model_econometric,
model_eh_econometric_interaction_years,
se = se_list,
#single.row = TRUE,
covariate.labels = c("Economic History", "Econometric",
paste0("Year:", (2000:2018)),
paste0("Journal: ", as.vector(source_title_coefs)),
"Economic History $\\times$ Econometric",
paste0("Economic History $\\times$ ", (2000:2018))),
dep.var.labels = "Citations",
type = "text")
# save# modelsave
ggsave("output/plot_changes.pdf", plot_changes, width = 10, height = 6)
